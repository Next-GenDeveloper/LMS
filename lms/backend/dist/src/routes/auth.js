import { Router } from 'express';
import { registerUser, loginUser, promoteUserRole } from '../controllers/authController.ts';
import { signupValidation, loginValidation, validate } from '../utils/Validators.ts';
import { authRateLimit } from '../middleware/security.ts';
const router = Router();
router.post('/register', authRateLimit, validate(signupValidation), registerUser);
router.post('/login', authRateLimit, validate(loginValidation), loginUser);
// Dev-only: promote a user to instructor/admin (secure later)
router.post('/promote', authRateLimit, promoteUserRole);
export default router;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXV0aC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9yb3V0ZXMvYXV0aC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sU0FBUyxDQUFDO0FBQ2pDLE9BQU8sRUFBRSxZQUFZLEVBQUUsU0FBUyxFQUFFLGVBQWUsRUFBRSxNQUFNLGtDQUFrQyxDQUFDO0FBQzVGLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxlQUFlLEVBQUUsUUFBUSxFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFDckYsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLDJCQUEyQixDQUFDO0FBRTFELE1BQU0sTUFBTSxHQUFHLE1BQU0sRUFBRSxDQUFDO0FBRXhCLE1BQU0sQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLGFBQWEsRUFBRSxRQUFRLENBQUMsZ0JBQWdCLENBQUMsRUFBRSxZQUFZLENBQUMsQ0FBQztBQUNsRixNQUFNLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRSxhQUFhLEVBQUUsUUFBUSxDQUFDLGVBQWUsQ0FBQyxFQUFFLFNBQVMsQ0FBQyxDQUFDO0FBQzNFLDhEQUE4RDtBQUM5RCxNQUFNLENBQUMsSUFBSSxDQUFDLFVBQVUsRUFBRSxhQUFhLEVBQUUsZUFBZSxDQUFDLENBQUM7QUFFeEQsZUFBZSxNQUFNLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSb3V0ZXIgfSBmcm9tICdleHByZXNzJztcclxuaW1wb3J0IHsgcmVnaXN0ZXJVc2VyLCBsb2dpblVzZXIsIHByb21vdGVVc2VyUm9sZSB9IGZyb20gJy4uL2NvbnRyb2xsZXJzL2F1dGhDb250cm9sbGVyLnRzJztcclxuaW1wb3J0IHsgc2lnbnVwVmFsaWRhdGlvbiwgbG9naW5WYWxpZGF0aW9uLCB2YWxpZGF0ZSB9IGZyb20gJy4uL3V0aWxzL1ZhbGlkYXRvcnMudHMnO1xyXG5pbXBvcnQgeyBhdXRoUmF0ZUxpbWl0IH0gZnJvbSAnLi4vbWlkZGxld2FyZS9zZWN1cml0eS50cyc7XHJcblxyXG5jb25zdCByb3V0ZXIgPSBSb3V0ZXIoKTtcclxuXHJcbnJvdXRlci5wb3N0KCcvcmVnaXN0ZXInLCBhdXRoUmF0ZUxpbWl0LCB2YWxpZGF0ZShzaWdudXBWYWxpZGF0aW9uKSwgcmVnaXN0ZXJVc2VyKTtcclxucm91dGVyLnBvc3QoJy9sb2dpbicsIGF1dGhSYXRlTGltaXQsIHZhbGlkYXRlKGxvZ2luVmFsaWRhdGlvbiksIGxvZ2luVXNlcik7XHJcbi8vIERldi1vbmx5OiBwcm9tb3RlIGEgdXNlciB0byBpbnN0cnVjdG9yL2FkbWluIChzZWN1cmUgbGF0ZXIpXHJcbnJvdXRlci5wb3N0KCcvcHJvbW90ZScsIGF1dGhSYXRlTGltaXQsIHByb21vdGVVc2VyUm9sZSk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCByb3V0ZXI7XHJcbiJdfQ==