import * as expressValidator from 'express-validator';
const { body, validationResult } = expressValidator;
export const validate = (validations) => {
    return async (req, res, next) => {
        for (const validation of validations) {
            const result = await validation.run(req);
            if (!result.isEmpty()) {
                return res.status(400).json({ errors: result.array() });
            }
        }
        next();
    };
};
export const strongPassword = body('password')
    .isLength({ min: 8 }).withMessage('Password must be at least 8 characters')
    .matches(/[A-Z]/).withMessage('Password must include at least one uppercase letter')
    .matches(/[a-z]/).withMessage('Password must include at least one lowercase letter')
    .matches(/[0-9]/).withMessage('Password must include at least one digit')
    .matches(/[^A-Za-z0-9]/).withMessage('Password must include at least one special character');
export const signupValidation = [
    body('email').isEmail().normalizeEmail(),
    strongPassword,
    body('fullName').notEmpty().trim(),
];
export const loginValidation = [
    body('email').isEmail().normalizeEmail(),
    body('password').notEmpty().isLength({ min: 8 }).withMessage('Invalid password'),
];
export const changePasswordValidation = [
    body('currentPassword').optional().isLength({ min: 8 }),
    strongPassword.withMessage('New password does not meet complexity requirements').bail(),
];
export const courseValidation = [
    body('title').notEmpty().trim(),
    body('description').notEmpty().trim(),
    body('category').notEmpty(),
    body('price').isFloat({ min: 0 }),
];
export const enrollmentValidation = [
    body('courseId').notEmpty(),
];
export const userProfileValidation = [
    body('firstName').optional().isLength({ min: 1, max: 50 }).trim().escape(),
    body('lastName').optional().isLength({ min: 1, max: 50 }).trim().escape(),
    body('email').optional().isEmail().normalizeEmail(),
    body('bio').optional().isLength({ max: 500 }).trim().escape(),
    body('phone').optional().isMobilePhone('any').trim(),
    body('profilePicture').optional().isURL().trim(),
    body('preferences.interests').optional().isArray(),
    body('preferences.interests.*').optional().isLength({ max: 50 }).trim().escape(),
    body('preferences.preferredLanguage').optional().isIn(['en', 'ur', 'hi']),
    body('preferences.notifications').optional().isBoolean(),
];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVmFsaWRhdG9ycy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy91dGlscy9WYWxpZGF0b3JzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sS0FBSyxnQkFBZ0IsTUFBTSxtQkFBbUIsQ0FBQztBQUN0RCxNQUFNLEVBQUUsSUFBSSxFQUFFLGdCQUFnQixFQUFFLEdBQUcsZ0JBQXVCLENBQUM7QUFJM0QsTUFBTSxDQUFDLE1BQU0sUUFBUSxHQUFHLENBQUMsV0FBOEIsRUFBRSxFQUFFO0lBQ3pELE9BQU8sS0FBSyxFQUFFLEdBQVksRUFBRSxHQUFhLEVBQUUsSUFBa0IsRUFBRSxFQUFFO1FBQy9ELEtBQUssTUFBTSxVQUFVLElBQUksV0FBVyxFQUFFLENBQUM7WUFDckMsTUFBTSxNQUFNLEdBQUcsTUFBTSxVQUFVLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQ3pDLElBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxFQUFFLEVBQUUsQ0FBQztnQkFDdEIsT0FBTyxHQUFHLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLE1BQU0sRUFBRSxNQUFNLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1lBQzFELENBQUM7UUFDSCxDQUFDO1FBQ0QsSUFBSSxFQUFFLENBQUM7SUFDVCxDQUFDLENBQUM7QUFDSixDQUFDLENBQUM7QUFFRixNQUFNLENBQUMsTUFBTSxjQUFjLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQztLQUMzQyxRQUFRLENBQUMsRUFBRSxHQUFHLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxXQUFXLENBQUMsd0NBQXdDLENBQUM7S0FDMUUsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDLFdBQVcsQ0FBQyxxREFBcUQsQ0FBQztLQUNuRixPQUFPLENBQUMsT0FBTyxDQUFDLENBQUMsV0FBVyxDQUFDLHFEQUFxRCxDQUFDO0tBQ25GLE9BQU8sQ0FBQyxPQUFP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QUksRUFBRSxDQUFDLE1BQU0sRUFBRTtJQUNoRixJQUFJLENBQUMsK0JBQStCLENBQUMsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ3pFLElBQUksQ0FBQywyQkFBMkIsQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFDLFNBQVMsRUFBRTtDQUN6RCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgZXhwcmVzc1ZhbGlkYXRvciBmcm9tICdleHByZXNzLXZhbGlkYXRvcic7XHJcbmNvbnN0IHsgYm9keSwgdmFsaWRhdGlvblJlc3VsdCB9ID0gZXhwcmVzc1ZhbGlkYXRvciBhcyBhbnk7XHJcbmltcG9ydCB0eXBlIHsgUmVxdWVzdCwgUmVzcG9uc2UsIE5leHRGdW5jdGlvbiB9IGZyb20gJ2V4cHJlc3MnO1xyXG50eXBlIFZhbGlkYXRpb25DaGFpbiA9IGFueTtcclxuXHJcbmV4cG9ydCBjb25zdCB2YWxpZGF0ZSA9ICh2YWxpZGF0aW9uczogVmFsaWRhdGlvbkNoYWluW10pID0+IHtcclxuICByZXR1cm4gYXN5bmMgKHJlcTogUmVxdWVzdCwgcmVzOiBSZXNwb25zZSwgbmV4dDogTmV4dEZ1bmN0aW9uKSA9PiB7XHJcbiAgICBmb3IgKGNvbnN0IHZhbGlkYXRpb24gb2YgdmFsaWRhdGlvbnMpIHtcclxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdmFsaWRhdGlvbi5ydW4ocmVxKTtcclxuICAgICAgaWYgKCFyZXN1bHQuaXNFbXB0eSgpKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3JzOiByZXN1bHQuYXJyYXkoKSB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgbmV4dCgpO1xyXG4gIH07XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3Qgc3Ryb25nUGFzc3dvcmQgPSBib2R5KCdwYXNzd29yZCcpXHJcbiAgLmlzTGVuZ3RoKHsgbWluOiA4IH0pLndpdGhNZXNzYWdlKCdQYXNzd29yZCBtdXN0IGJlIGF0IGxlYXN0IDggY2hhcmFjdGVycycpXHJcbiAgLm1hdGNoZXMoL1tBLVpdLykud2l0aE1lc3NhZ2UoJ1Bhc3N3b3JkIG11c3QgaW5jbHVkZSBhdCBsZWFzdCBvbmUgdXBwZXJjYXNlIGxldHRlcicpXHJcbiAgLm1hdGNoZXMoL1thLXpdLykud2l0aE1lc3NhZ2UoJ1Bhc3N3b3JkIG11c3QgaW5jbHVkZSBhdCBsZWFzdCBvbmUgbG93ZXJjYXNlIGxldHRlcicpXHJcbiAgLm1hdGNoZXMoL1swLTldLykud2l0aE1lc3NhZ2UoJ1Bhc3N3b3JkIG11c3QgaW5jbHVkZSBhdCBsZWFzdCBvbmUgZGlnaXQnKVxyXG4gIC5tYXRjaGVzKC9bXkEtWmEtejAtOV0vKS53aXRoTWVzc2FnZSgnUGFzc3dvcmQgbXVzdCBpbmNsdWRlIGF0IGxlYXN0IG9uZSBzcGVjaWFsIGNoYXJhY3RlcicpO1xyXG5cclxuZXhwb3J0IGNvbnN0IHNpZ251cFZhbGlkYXRpb24gPSBbXHJcbiAgYm9keSgnZW1haWwnKS5pc0VtYWlsKCkubm9ybWFsaXplRW1haWwoKSxcclxuICBzdHJvbmdQYXNzd29yZCxcclxuICBib2R5KCdmdWxsTmFtZScpLm5vdEVtcHR5KCkudHJpbSgpLFxyXG5dO1xyXG5cclxuZXhwb3J0IGNvbnN0IGxvZ2luVmFsaWRhdGlvbiA9IFtcclxuICBib2R5KCdlbWFpbCcpLmlzRW1haWwoKS5ub3JtYWxpemVFbWFpbCgpLFxyXG4gIGJvZHkoJ3Bhc3N3b3JkJykubm90RW1wdHkoKS5pc0xlbmd0aCh7IG1pbjogOCB9KS53aXRoTWVzc2FnZSgnSW52YWxpZCBwYXNzd29yZCcpLFxyXG5dO1xyXG5cclxuZXhwb3J0IGNvbnN0IGNoYW5nZVBhc3N3b3JkVmFsaWRhdGlvbiA9IFtcclxuICBib2R5KCdjdXJyZW50UGFzc3dvcmQnKS5vcHRpb25hbCgpLmlzTGVuZ3RoKHsgbWluOiA4IH0pLFxyXG4gIHN0cm9uZ1Bhc3N3b3JkLndpdGhNZXNzYWdlKCdOZXcgcGFzc3dvcmQgZG9lcyBub3QgbWVldCBjb21wbGV4aXR5IHJlcXVpcmVtZW50cycpLmJhaWwoKSxcclxuXTtcclxuXHJcbmV4cG9ydCBjb25zdCBjb3Vyc2VWYWxpZGF0aW9uID0gW1xyXG4gIGJvZHkoJ3RpdGxlJykubm90RW1wdHkoKS50cmltKCksXHJcbiAgYm9keSgnZGVzY3JpcHRpb24nKS5ub3RFbXB0eSgpLnRyaW0oKSxcclxuICBib2R5KCdjYXRlZ29yeScpLm5vdEVtcHR5KCksXHJcbiAgYm9keSgncHJpY2UnKS5pc0Zsb2F0KHsgbWluOiAwIH0pLFxyXG5dO1xyXG5cclxuZXhwb3J0IGNvbnN0IGVucm9sbG1lbnRWYWxpZGF0aW9uID0gW1xyXG4gIGJvZHkoJ2NvdXJzZUlkJykubm90RW1wdHkoKSxcclxuXTtcclxuXHJcbmV4cG9ydCBjb25zdCB1c2VyUHJvZmlsZVZhbGlkYXRpb24gPSBbXHJcbiAgYm9keSgnZmlyc3ROYW1lJykub3B0aW9uYWwoKS5pc0xlbmd0aCh7IG1pbjogMSwgbWF4OiA1MCB9KS50cmltKCkuZXNjYXBlKCksXHJcbiAgYm9keSgnbGFzdE5hbWUnKS5vcHRpb25hbCgpLmlzTGVuZ3RoKHsgbWluOiAxLCBtYXg6IDUwIH0pLnRyaW0oKS5lc2NhcGUoKSxcclxuICBib2R5KCdlbWFpbCcpLm9wdGlvbmFsKCkuaXNFbWFpbCgpLm5vcm1hbGl6ZUVtYWlsKCksXHJcbiAgYm9keSgnYmlvJykub3B0aW9uYWwoKS5pc0xlbmd0aCh7IG1heDogNTAwIH0pLnRyaW0oKS5lc2NhcGUoKSxcclxuICBib2R5KCdwaG9uZScpLm9wdGlvbmFsKCkuaXNNb2JpbGVQaG9uZSgnYW55JykudHJpbSgpLFxyXG4gIGJvZHkoJ3Byb2ZpbGVQaWN0dXJlJykub3B0aW9uYWwoKS5pc1VSTCgpLnRyaW0oKSxcclxuICBib2R5KCdwcmVmZXJlbmNlcy5pbnRlcmVzdHMnKS5vcHRpb25hbCgpLmlzQXJyYXkoKSxcclxuICBib2R5KCdwcmVmZXJlbmNlcy5pbnRlcmVzdHMuKicpLm9wdGlvbmFsKCkuaXNMZW5ndGgoeyBtYXg6IDUwIH0pLnRyaW0oKS5lc2NhcGUoKSxcclxuICBib2R5KCdwcmVmZXJlbmNlcy5wcmVmZXJyZWRMYW5ndWFnZScpLm9wdGlvbmFsKCkuaXNJbihbJ2VuJywgJ3VyJywgJ2hpJ10pLFxyXG4gIGJvZHkoJ3ByZWZlcmVuY2VzLm5vdGlmaWNhdGlvbnMnKS5vcHRpb25hbCgpLmlzQm9vbGVhbigpLFxyXG5dOyJdfQ==